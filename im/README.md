---
description: 消息协议设计-基本协议
---

# 消息协议设计-基本协议

\
**需求：**

1. A客户端上行消息到服务器，服务器下行消息到B客户端。

**评估标准：**

1. 协议传输效率，尽可能降低端到端的延迟
2. 前后版本间的兼容
3. 控制消息包的大小，降低空间占用率
4. 减少编解码时造成的CPU使用率的权衡
5. 协议安全，防止协议被破解
6. 允许需求扩展
7. 跨平台接入：H5，客户端，IoT设备
8. 方便开发调试

**基本结构：**

> 协议可分为三层分析
>
> * 应用层
> * 安全层
> * 传输层

**应用层：**protobuf

好处：二进制传输，无编解码的CPU消耗，降低延迟和性能损耗

**安全层：**TLS3.0

好处：

传输层：TCP

面向连接的可靠传输协议，仅能保证数据达到目标端的传输层，维护状态消耗资源，网络不稳定时频繁重连性能差。

> 优化：弱网环境下可切换协议为UDP，避免频繁重连。

